import pandas as pd
import argparse


def analyze_write_random(data_path):
    data = pd.read_csv(data_path, delimiter=',')
    if data.columns.size != 2:
        raise ValueError('Invalid file; expected 2 columns')

    print(f'Using column "{data.columns[1]}" as time in microsends')
    time_microsec = data.iloc[:, 1]

    print(f'p50: {time_microsec.quantile(q=0.5)}')
    print(f'p95: {time_microsec.quantile(q=0.95)}')
    print(f'p99: {time_microsec.quantile(q=0.99)}')


if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('data_path', type=str, nargs=1,
                        help='path to the CSV data generated by the benchmarks')
    args = parser.parse_args()
    analyze_write_random(args.data_path[0])
